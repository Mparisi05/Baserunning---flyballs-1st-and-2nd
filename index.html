<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bronco Braves ‚Äî Fly Ball Base Running Drill</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #1a1c1e;
    --surface: #232629;
    --surface-hover: #2c2f33;
    --border: #3a3d42;
    --text: #e8e9ea;
    --text-muted: #8b9098;
    --accent-gold: #d4a843;
    --accent-blue: #4a90d9;
    --accent-red: #d94a4a;
    --accent-green: #4abd8c;
    --accent-orange: #e8943a;
    --accent-purple: #9b59b6;
    --field-green: #2d6b2d;
    --field-dark: #1e4d1e;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Nunito', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
  }

  /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
  header {
    background: var(--surface);
    border-bottom: 2px solid var(--accent-gold);
    padding: 14px 24px;
    display: flex; align-items: center; justify-content: space-between;
    flex-wrap: wrap; gap: 12px;
  }
  .team-brand { display: flex; align-items: center; gap: 12px; }
  .team-logo {
    font-size: 28px; width: 44px; height: 44px;
    background: var(--accent-gold); border-radius: 10px;
    display: flex; align-items: center; justify-content: center;
  }
  .team-name {
    font-family: 'Bebas Neue', sans-serif; font-size: 26px;
    letter-spacing: 2px; color: var(--accent-gold);
  }
  .team-sub {
    font-size: 11px; color: var(--text-muted); font-weight: 700;
    text-transform: uppercase; letter-spacing: 1px;
  }
  .header-controls { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
  .hdr-btn {
    font-family: 'Nunito', sans-serif; font-size: 12px; font-weight: 700;
    padding: 7px 14px; border-radius: 6px; cursor: pointer;
    border: 1px solid var(--border); background: var(--surface);
    color: var(--text-muted); transition: all 0.15s;
    text-transform: uppercase; letter-spacing: 0.5px;
  }
  .hdr-btn:hover { background: var(--surface-hover); color: var(--text); }
  .hdr-btn.active { background: var(--accent-gold); color: #1a1c1e; border-color: var(--accent-gold); }

  /* ‚îÄ‚îÄ LAYOUT ‚îÄ‚îÄ */
  .main-layout { display: flex; height: calc(100vh - 72px); overflow: hidden; }

  /* ‚îÄ‚îÄ SIDE PANEL ‚îÄ‚îÄ */
  .side-panel {
    width: 320px; min-width: 320px;
    background: var(--bg);
    border-right: 1px solid var(--border);
    display: flex; flex-direction: column; overflow: hidden;
  }
  .panel-tabs {
    display: flex; border-bottom: 1px solid var(--border);
  }
  .panel-tab {
    flex: 1; padding: 10px 8px; text-align: center;
    font-size: 11px; font-weight: 800; text-transform: uppercase;
    letter-spacing: 0.8px; color: var(--text-muted);
    cursor: pointer; border-bottom: 2px solid transparent;
    transition: all 0.15s; background: transparent; border-top: none;
    border-left: none; border-right: none;
  }
  .panel-tab:hover { color: var(--text); }
  .panel-tab.active { color: var(--accent-gold); border-bottom-color: var(--accent-gold); }
  .panel-content { flex: 1; overflow-y: auto; padding: 16px; }
  .panel-content.hidden { display: none; }

  /* ‚îÄ‚îÄ ROSTER IN PANEL ‚îÄ‚îÄ */
  .roster-section-label {
    font-family: 'Bebas Neue', sans-serif; font-size: 16px;
    letter-spacing: 1.5px; color: var(--accent-gold);
    margin-bottom: 8px; display: flex; align-items: center; gap: 8px;
  }
  .roster-section-label .count {
    font-family: 'Nunito', sans-serif; font-size: 10px; font-weight: 800;
    background: var(--accent-gold); color: #1a1c1e;
    padding: 2px 7px; border-radius: 10px;
  }
  .roster-section-label .count.red {
    background: var(--accent-red); color: #fff;
  }

  .player-tile {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 8px; padding: 8px 10px; margin-bottom: 4px;
    display: flex; align-items: center; gap: 8px;
    transition: all 0.15s; user-select: none; cursor: pointer;
  }
  .player-tile:hover { border-color: var(--accent-gold); background: var(--surface-hover); }
  .player-tile .jersey {
    font-family: 'Bebas Neue', sans-serif; font-size: 18px;
    color: var(--accent-gold); min-width: 26px; text-align: center;
  }
  .player-tile .pname {
    font-size: 12px; font-weight: 700; flex: 1;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  }
  .player-tile .tile-action {
    width: 22px; height: 22px; border-radius: 4px;
    border: 1px solid var(--border); background: transparent;
    color: var(--text-muted); font-size: 12px; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    transition: all 0.15s; flex-shrink: 0;
  }
  .player-tile.absent { background: #2a1e1e; border-color: #5a2a2a; opacity: 0.55; }
  .player-tile.absent .tile-action { background: var(--accent-red); border-color: var(--accent-red); color: #fff; }
  .player-tile.assigned { border-color: var(--accent-green); background: #1e2e24; }
  .player-tile .group-badge {
    font-size: 9px; font-weight: 800; padding: 2px 6px;
    border-radius: 4px; text-transform: uppercase; letter-spacing: 0.5px;
  }
  .group-badge.g1 { background: rgba(74, 144, 217, 0.2); color: var(--accent-blue); }
  .group-badge.g2 { background: rgba(232, 148, 58, 0.2); color: var(--accent-orange); }

  /* ‚îÄ‚îÄ COACHING NOTES ‚îÄ‚îÄ */
  .note-card {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 10px; padding: 16px; margin-bottom: 12px;
  }
  .note-card-title {
    font-family: 'Bebas Neue', sans-serif; font-size: 17px;
    letter-spacing: 1px; margin-bottom: 8px;
    display: flex; align-items: center; gap: 8px;
  }
  .note-card-title .icon { font-size: 18px; }
  .note-card p {
    font-size: 13px; line-height: 1.6; color: var(--text-muted); margin-bottom: 8px;
  }
  .note-card p:last-child { margin-bottom: 0; }
  .note-card strong { color: var(--text); }
  .note-card .highlight {
    background: rgba(212, 168, 67, 0.12); border-left: 3px solid var(--accent-gold);
    padding: 8px 12px; border-radius: 0 6px 6px 0; margin: 8px 0;
    font-size: 12px; line-height: 1.5; color: var(--text);
  }
  .note-card .scenario {
    background: var(--surface-hover); border-radius: 6px;
    padding: 10px 12px; margin: 6px 0;
  }
  .note-card .scenario-label {
    font-size: 10px; font-weight: 800; text-transform: uppercase;
    letter-spacing: 1px; margin-bottom: 4px;
  }
  .note-card .scenario p { font-size: 12px; margin-bottom: 4px; }
  .scenario-label.deep { color: var(--accent-blue); }
  .scenario-label.medium { color: var(--accent-orange); }
  .scenario-label.shallow { color: var(--accent-green); }
  .scenario-label.first { color: var(--accent-purple); }

  /* ‚îÄ‚îÄ FIELD AREA ‚îÄ‚îÄ */
  .field-area {
    flex: 1; position: relative; overflow: hidden;
    background: var(--field-green);
    background-image: radial-gradient(ellipse 90% 70% at 50% 95%, var(--field-dark) 0%, transparent 70%);
  }
  .field-svg {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
  }

  /* ‚îÄ‚îÄ FIELD ELEMENTS ‚îÄ‚îÄ */
  .field-marker {
    position: absolute; transform: translate(-50%, -50%);
    z-index: 10; display: flex; flex-direction: column;
    align-items: center; gap: 2px;
  }
  .marker-label {
    font-family: 'Bebas Neue', sans-serif; font-size: 12px;
    letter-spacing: 1px; color: rgba(255,255,255,0.6);
    text-shadow: 0 1px 4px rgba(0,0,0,0.6);
  }
  .marker-tile {
    min-width: 110px; padding: 6px 10px;
    border-radius: 8px; display: flex; align-items: center;
    gap: 6px; backdrop-filter: blur(4px);
    font-size: 11px; font-weight: 700;
  }
  .marker-tile.coach {
    border: 2px solid var(--accent-blue);
    background: rgba(20, 40, 70, 0.85); color: var(--accent-blue);
  }
  .marker-tile.player-group {
    border: 2px solid var(--accent-green);
    background: rgba(20, 50, 30, 0.85); color: var(--text);
  }
  .marker-tile .tile-icon { font-size: 14px; }
  .marker-tile .tile-text { flex: 1; }
  .marker-tile .tile-count {
    font-family: 'Bebas Neue', sans-serif; font-size: 16px; color: var(--accent-gold);
  }

  /* Player group with stacked names */
  .group-stack {
    min-width: 120px; border-radius: 8px; overflow: hidden;
    backdrop-filter: blur(4px);
  }
  .group-stack-header {
    padding: 5px 10px; font-size: 10px; font-weight: 800;
    text-transform: uppercase; letter-spacing: 1px;
    display: flex; align-items: center; gap: 6px;
  }
  .group-stack-header.g1 { background: rgba(74, 144, 217, 0.3); color: var(--accent-blue); }
  .group-stack-header.g2 { background: rgba(232, 148, 58, 0.3); color: var(--accent-orange); }
  .group-stack-body {
    background: rgba(20, 20, 25, 0.85);
    border: 2px solid rgba(255,255,255,0.15); border-top: none;
    border-radius: 0 0 8px 8px;
  }
  .group-player {
    padding: 4px 10px; font-size: 11px; font-weight: 700;
    display: flex; align-items: center; gap: 6px;
    border-bottom: 1px solid rgba(255,255,255,0.05);
  }
  .group-player:last-child { border-bottom: none; }
  .group-player .jersey {
    font-family: 'Bebas Neue', sans-serif; font-size: 15px; color: var(--accent-gold);
    min-width: 22px; text-align: center;
  }

  /* Arrow / direction indicators */
  .drill-arrow {
    position: absolute; z-index: 5; transform: translate(-50%, -50%);
    pointer-events: none;
  }

  /* Lob zone indicator */
  .lob-zone {
    position: absolute; z-index: 3;
    border: 2px dashed rgba(232, 148, 58, 0.4);
    border-radius: 50%;
    background: rgba(232, 148, 58, 0.06);
    transform: translate(-50%, -50%);
  }
  .lob-zone-label {
    position: absolute; top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    font-size: 10px; font-weight: 800; text-transform: uppercase;
    letter-spacing: 1px; color: rgba(232, 148, 58, 0.5);
    white-space: nowrap;
  }

  /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
  @media (max-width: 900px) {
    .main-layout { flex-direction: column; height: auto; }
    .side-panel { width: 100%; min-width: 100%; max-height: 45vh; border-right: none; border-bottom: 1px solid var(--border); }
    .field-area { min-height: 500px; }
  }
</style>
</head>
<body>

<header>
  <div class="team-brand">
    <div class="team-logo">‚öæ</div>
    <div>
      <div class="team-name">BRONCO BRAVES</div>
      <div class="team-sub">Fly Ball Reads ‚Äî Base Running Drill</div>
    </div>
  </div>
  <div class="header-controls">
    <button class="hdr-btn active" onclick="switchView('field')">‚¨¶ Field</button>
    <button class="hdr-btn" onclick="switchView('notes')">üìã Coach Notes</button>
  </div>
</header>

<div class="main-layout">
  <!-- Side Panel -->
  <div class="side-panel">
    <div class="panel-tabs">
      <button class="panel-tab active" onclick="switchTab('roster',this)">Roster</button>
      <button class="panel-tab" onclick="switchTab('reads',this)">2B Reads</button>
      <button class="panel-tab" onclick="switchTab('first',this)">1B Reads</button>
    </div>

    <!-- ROSTER TAB -->
    <div class="panel-content" id="tab-roster">
      <div style="margin-bottom:12px;">
        <div class="roster-section-label">
          <span>üèÉ Group 1 ‚Äî Runners at 1B</span>
          <span class="count" id="g1Count">0</span>
        </div>
        <div id="group1Area"></div>
        <div style="margin-top:4px;">
          <div class="roster-section-label" style="margin-top:12px;">
            <span>üèÉ Group 2 ‚Äî Runners at 2B</span>
            <span class="count" id="g2Count">0</span>
          </div>
          <div id="group2Area"></div>
        </div>
      </div>

      <div style="border-top:1px solid var(--border); padding-top:12px; margin-top:8px;">
        <div class="roster-section-label">
          <span>Unassigned</span>
          <span class="count" id="unassignedCount" style="background:var(--border);">0</span>
        </div>
        <div id="unassignedArea"></div>
      </div>

      <div style="border-top:1px solid var(--border); padding-top:12px; margin-top:12px;">
        <div class="roster-section-label">
          <span style="color:var(--accent-red);">Absent</span>
          <span class="count red" id="absentCount">0</span>
        </div>
        <div id="absentArea"></div>
      </div>
    </div>

    <!-- 2B READS TAB -->
    <div class="panel-content hidden" id="tab-reads">
      <div class="note-card">
        <div class="note-card-title" style="color:var(--accent-blue);">
          <span class="icon">üß†</span> Runner on 2nd ‚Äî Fly Ball Reads
        </div>
        <p>Start with your <strong>lead</strong>, then take your <strong>secondary</strong> as the pitch comes. When the ball is hit in the air, read the situation:</p>

        <div class="scenario">
          <div class="scenario-label deep">üîµ Deep fly ‚Äî outfielder going back</div>
          <p><strong>One-Third Way Rule:</strong> Get roughly ‚Öì of the way to third. You should be <strong>3 hard steps from getting back</strong> to 2nd.</p>
          <p>If the outfielder is drifting back and the ball gets over their head ‚Üí you score easily.</p>
          <p>If they catch it going backwards ‚Üí 3 steps back, touch the bag, hold.</p>
        </div>

        <div class="scenario">
          <div class="scenario-label medium">üü† Medium-deep fly ‚Äî outfielder camped under it</div>
          <p>If the fielder is <strong>settled and camped</strong> under a ball that's deep enough for you to tag and beat the throw to 3rd ‚Üí <strong>tag immediately</strong>.</p>
          <div class="highlight">
            üí° Key read: Is the throw from where the fielder catches it far enough that I can beat it to 3rd? If yes ‚Äî <strong>tag up on contact.</strong>
          </div>
        </div>

        <div class="scenario">
          <div class="scenario-label shallow">üü¢ Short fly ‚Äî near the infield</div>
          <p>Ball is hit shallow enough that you <strong>cannot</strong> tag and make it to 3rd.</p>
          <p>Get as far off the bag as possible toward 3rd ‚Äî if it drops, you score. If it's caught, you need to get back before the throw reaches 2nd.</p>
          <div class="highlight">
            üí° Aggressive off the base, but not so far you can't get back on a catch-and-throw to 2B.
          </div>
        </div>
      </div>
    </div>

    <!-- 1B READS TAB -->
    <div class="panel-content hidden" id="tab-first">
      <div class="note-card">
        <div class="note-card-title" style="color:var(--accent-purple);">
          <span class="icon">üß†</span> Runner on 1st ‚Äî Fly Ball Reads
        </div>
        <p>Start with your <strong>lead</strong>, then take your <strong>secondary</strong>. On a fly ball to right field:</p>

        <div class="scenario">
          <div class="scenario-label first">üü£ Key rule: Rarely tag from 1st</div>
          <p>The throw from right field to 2nd base is <strong>short</strong>. Tagging up from 1st on a fly ball to RF almost always gets you thrown out.</p>
          <div class="highlight">
            üí° Instead: Get as far off 1st as you can while the ball is in the air ‚Äî <strong>but always be able to get back</strong> if the fielder catches it and throws to 1st.
          </div>
        </div>

        <div class="scenario">
          <div class="scenario-label shallow">üü¢ If the ball drops</div>
          <p>Because you've extended your lead aggressively, you're already halfway to 2nd ‚Üí advance easily.</p>
        </div>

        <div class="scenario">
          <div class="scenario-label deep">üîµ If it's caught</div>
          <p>Retreat back to 1st safely. The outfielder's throw will likely go to 2nd or a cutoff ‚Äî not back to 1st unless you're way too far off.</p>
        </div>

        <p style="margin-top:8px;"><strong>Mindset:</strong> Be aggressive but smart. Your job is to gain free distance ‚Äî not to tag.</p>
      </div>
    </div>
  </div>

  <!-- Field -->
  <div class="field-area" id="fieldArea">
    <svg class="field-svg" viewBox="0 0 1000 1000" preserveAspectRatio="xMidYMid meet">
      <path d="M 20 950 Q 20 150 500 30 Q 980 150 980 950 Z" fill="#2d6b2d" stroke="none"/>
      <polygon points="500,430 710,650 500,870 290,650" fill="#c4975a" opacity="0.25" stroke="rgba(255,255,255,0.12)" stroke-width="1.5"/>
      <line x1="500" y1="870" x2="710" y2="650" stroke="rgba(255,255,255,0.15)" stroke-width="2"/>
      <line x1="710" y1="650" x2="500" y2="430" stroke="rgba(255,255,255,0.15)" stroke-width="2"/>
      <line x1="500" y1="430" x2="290" y2="650" stroke="rgba(255,255,255,0.15)" stroke-width="2"/>
      <line x1="290" y1="650" x2="500" y2="870" stroke="rgba(255,255,255,0.15)" stroke-width="2"/>
      <circle cx="500" cy="640" r="14" fill="#c4975a" opacity="0.4"/>
      <rect x="493" y="863" width="14" height="14" fill="white" transform="rotate(45 500 870)" opacity="0.6"/>
      <rect x="703" y="643" width="12" height="12" fill="white" transform="rotate(45 709 649)" opacity="0.6"/>
      <rect x="494" y="423" width="12" height="12" fill="white" transform="rotate(45 500 429)" opacity="0.6"/>
      <rect x="284" y="643" width="12" height="12" fill="white" transform="rotate(45 290 649)" opacity="0.6"/>
      <line x1="500" y1="870" x2="30" y2="350" stroke="rgba(255,255,255,0.1)" stroke-width="1.5"/>
      <line x1="500" y1="870" x2="970" y2="350" stroke="rgba(255,255,255,0.1)" stroke-width="1.5"/>
      <path d="M 100 400 Q 500 80 900 400" fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="2"/>
    </svg>

    <!-- Lob Zone -->
    <div class="lob-zone" style="left:72%;top:28%;width:220px;height:180px;">
      <div class="lob-zone-label">üéæ Lob Zone</div>
    </div>

    <!-- Field markers will be rendered by JS -->
    <div id="fieldMarkers"></div>
  </div>
</div>

<script>
const PLAYERS = [
  { id: 1, jersey: 24, name: "J. Reinhardt", first: "Jackson" },
  { id: 2, jersey: 23, name: "H. Reinhardt", first: "Henry" },
  { id: 3, jersey: 67, name: "B. Cox", first: "Brooks" },
  { id: 4, jersey: 7, name: "R. Sullivan", first: "Ryder" },
  { id: 5, jersey: 44, name: "G. Williams", first: "Graham W." },
  { id: 6, jersey: 4, name: "C. Coleman", first: "Chandler" },
  { id: 7, jersey: 9, name: "M. Cage", first: "Miles" },
  { id: 8, jersey: 8, name: "M. Warren", first: "Micah" },
  { id: 9, jersey: 16, name: "L. Fraser", first: "Langston" },
  { id: 10, jersey: 27, name: "N. Crosby", first: "Neal" },
  { id: 11, jersey: 99, name: "G. Sprague", first: "Graham S." },
  { id: 12, jersey: 2, name: "F. Butler", first: "Ford" }
];

// State
let groups = { 1: [], 2: [] }; // group number -> player ids
let absentSet = new Set();

function getAssignedIds() {
  return new Set([...groups[1], ...groups[2]]);
}

function assignPlayer(id, group) {
  // Remove from any current group
  groups[1] = groups[1].filter(x => x !== id);
  groups[2] = groups[2].filter(x => x !== id);
  if (group) groups[group].push(id);
  render();
}

function toggleAbsent(id) {
  groups[1] = groups[1].filter(x => x !== id);
  groups[2] = groups[2].filter(x => x !== id);
  if (absentSet.has(id)) absentSet.delete(id);
  else absentSet.add(id);
  render();
}

function autoSplit() {
  const available = PLAYERS.filter(p => !absentSet.has(p.id)).map(p => p.id);
  // Shuffle
  for (let i = available.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [available[i], available[j]] = [available[j], available[i]];
  }
  const half = Math.ceil(available.length / 2);
  groups[1] = available.slice(0, half);
  groups[2] = available.slice(half);
  render();
}

function clearGroups() {
  groups = { 1: [], 2: [] };
  render();
}

function render() {
  renderRoster();
  renderField();
}

function renderRoster() {
  const assigned = getAssignedIds();

  // Group 1
  const g1El = document.getElementById('group1Area');
  g1El.innerHTML = groups[1].length === 0
    ? '<div style="padding:8px;color:var(--text-muted);font-size:11px;text-align:center;">Click a player below to assign</div>'
    : groups[1].map(id => {
        const p = PLAYERS.find(x => x.id === id);
        return playerHTML(p, 1);
      }).join('');
  document.getElementById('g1Count').textContent = groups[1].length;

  // Group 2
  const g2El = document.getElementById('group2Area');
  g2El.innerHTML = groups[2].length === 0
    ? '<div style="padding:8px;color:var(--text-muted);font-size:11px;text-align:center;">Click a player below to assign</div>'
    : groups[2].map(id => {
        const p = PLAYERS.find(x => x.id === id);
        return playerHTML(p, 2);
      }).join('');
  document.getElementById('g2Count').textContent = groups[2].length;

  // Unassigned
  const unassigned = PLAYERS.filter(p => !assigned.has(p.id) && !absentSet.has(p.id));
  const uEl = document.getElementById('unassignedArea');
  uEl.innerHTML = unassigned.length === 0
    ? '<div style="padding:8px;color:var(--text-muted);font-size:11px;text-align:center;">All players assigned</div>'
    : `<div style="display:flex;gap:4px;margin-bottom:8px;">
        <button onclick="autoSplit()" style="flex:1;font-family:'Nunito',sans-serif;font-size:11px;font-weight:700;padding:6px;border-radius:6px;border:1px solid var(--accent-gold);background:rgba(212,168,67,0.1);color:var(--accent-gold);cursor:pointer;">‚ö° Auto-Split Groups</button>
        <button onclick="clearGroups()" style="font-family:'Nunito',sans-serif;font-size:11px;font-weight:700;padding:6px 10px;border-radius:6px;border:1px solid var(--border);background:transparent;color:var(--text-muted);cursor:pointer;">Clear</button>
      </div>` +
      unassigned.map(p => playerHTML(p, 0)).join('');
  document.getElementById('unassignedCount').textContent = unassigned.length;

  // Absent
  const absent = PLAYERS.filter(p => absentSet.has(p.id));
  const aEl = document.getElementById('absentArea');
  aEl.innerHTML = absent.length === 0
    ? '<div style="padding:8px;color:var(--text-muted);font-size:11px;text-align:center;">No absences</div>'
    : absent.map(p => playerHTML(p, -1)).join('');
  document.getElementById('absentCount').textContent = absent.length;
}

function playerHTML(p, group) {
  // group: 0=unassigned, 1=group1, 2=group2, -1=absent
  let cls = 'player-tile';
  if (group === -1) cls += ' absent';
  if (group > 0) cls += ' assigned';

  let badge = '';
  if (group === 1) badge = '<span class="group-badge g1">1B</span>';
  if (group === 2) badge = '<span class="group-badge g2">2B</span>';

  let actions = '';
  if (group === -1) {
    actions = `<button class="tile-action" onclick="toggleAbsent(${p.id})" title="Mark present" style="background:var(--accent-red);border-color:var(--accent-red);color:#fff;">‚úì</button>`;
  } else if (group === 0) {
    actions = `
      <button class="tile-action" onclick="assignPlayer(${p.id},1)" title="Assign to Group 1 (1B)" style="color:var(--accent-blue);border-color:var(--accent-blue);font-size:10px;font-weight:800;">1B</button>
      <button class="tile-action" onclick="assignPlayer(${p.id},2)" title="Assign to Group 2 (2B)" style="color:var(--accent-orange);border-color:var(--accent-orange);font-size:10px;font-weight:800;">2B</button>
      <button class="tile-action" onclick="toggleAbsent(${p.id})" title="Mark absent">‚úï</button>
    `;
  } else {
    actions = `<button class="tile-action" onclick="assignPlayer(${p.id},0)" title="Unassign">‚Ü©</button>`;
  }

  return `<div class="${cls}">
    <span class="jersey">${p.jersey}</span>
    <span class="pname">${p.name}</span>
    ${badge}
    ${actions}
  </div>`;
}

function renderField() {
  const container = document.getElementById('fieldMarkers');
  container.innerHTML = '';

  // Coach: Lofting tennis balls (between home and RF)
  addMarker(container, 60, 85, 'üß¢', 'Coach', 'Lofting Tennis Balls', 'coach');

  // Coach: Working with runners at 1st
  addMarker(container, 73, 68, 'üß¢', 'Coach', '1B Runner Coach', 'coach');

  // Coach: Working with runners at 2nd
  addMarker(container, 48, 42, 'üß¢', 'Coach', '2B Runner Coach', 'coach');

  // Coach: Right field making plays
  addMarker(container, 78, 32, 'üß¢', 'Coach', 'RF Fielder (Reads)', 'coach');

  // Player groups at 1st base
  addGroupStack(container, 72, 58, 1, 'üèÉ Group 1 ‚Äî 1st Base');

  // Player groups at 2nd base
  addGroupStack(container, 36, 48, 2, 'üèÉ Group 2 ‚Äî 2nd Base');
}

function addMarker(container, x, y, icon, label, sublabel, type) {
  const div = document.createElement('div');
  div.className = 'field-marker';
  div.style.left = x + '%';
  div.style.top = y + '%';
  div.innerHTML = `
    <div class="marker-tile ${type}">
      <span class="tile-icon">${icon}</span>
      <div>
        <div class="tile-text" style="font-size:11px;font-weight:800;">${label}</div>
        <div style="font-size:9px;opacity:0.7;font-weight:600;">${sublabel}</div>
      </div>
    </div>
  `;
  container.appendChild(div);
}

function addGroupStack(container, x, y, groupNum, title) {
  const div = document.createElement('div');
  div.className = 'field-marker';
  div.style.left = x + '%';
  div.style.top = y + '%';

  const players = groups[groupNum].map(id => PLAYERS.find(p => p.id === id));
  const gClass = groupNum === 1 ? 'g1' : 'g2';

  let playersHTML = '';
  if (players.length === 0) {
    playersHTML = '<div style="padding:8px 10px;font-size:10px;color:var(--text-muted);text-align:center;">No players assigned</div>';
  } else {
    playersHTML = players.map(p =>
      `<div class="group-player"><span class="jersey">${p.jersey}</span><span>${p.name}</span></div>`
    ).join('');
  }

  div.innerHTML = `
    <div class="group-stack">
      <div class="group-stack-header ${gClass}">
        <span>üèÉ</span>
        <span>${title}</span>
        <span style="margin-left:auto;font-family:'Bebas Neue',sans-serif;font-size:16px;">${players.length}</span>
      </div>
      <div class="group-stack-body">${playersHTML}</div>
    </div>
  `;
  container.appendChild(div);
}

function switchTab(tabId, btn) {
  document.querySelectorAll('.panel-tab').forEach(t => t.classList.remove('active'));
  btn.classList.add('active');
  document.querySelectorAll('.panel-content').forEach(c => c.classList.add('hidden'));
  document.getElementById('tab-' + tabId).classList.remove('hidden');
}

function switchView(view) {
  document.querySelectorAll('.hdr-btn').forEach(b => b.classList.remove('active'));
  event.target.classList.add('active');
  // For now both views show the same layout ‚Äî could expand to full-screen notes view
}

// Init
render();
</script>
</body>
</html>
